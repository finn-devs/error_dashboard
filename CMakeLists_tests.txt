cmake_minimum_required(VERSION 3.16)

# Add test executable
add_executable(test_errorsurface
    test_errorsurface.cpp
    ../src/logentry.h
    ../src/logcollector.h
    ../src/logcollector.cpp
    ../src/threatdetector.h
    ../src/threatdetector.cpp
    ../src/statstab.h
    ../src/statstab.cpp
    ../src/mainwindow.h
    ../src/mainwindow.cpp
)

# Qt auto-processing
set_target_properties(test_errorsurface PROPERTIES
    AUTOMOC ON
    AUTORCC ON
    AUTOUIC ON
)

# Link Qt libraries
target_link_libraries(test_errorsurface
    Qt6::Core
    Qt6::Gui
    Qt6::Widgets
    Qt6::Charts
    Qt6::Test
    systemd
)

# Include directories
target_include_directories(test_errorsurface PRIVATE
    ${CMAKE_CURRENT_SOURCE_DIR}/../src
)

# Add test to CTest
add_test(NAME ErrorSurfaceTests COMMAND test_errorsurface)

# Enable CTest
enable_testing()
